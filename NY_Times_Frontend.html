<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>New York Times</title>
    <link href="style.css" rel="stylesheet" type="text/css" />
    <style>

      body {
        font-family: Tahoma;
      }
            h1 {
        color: darkblue;
        text-align: center;
        font-family: Times;
      }
h4 {
padding-bottom: 0;
margin-bottom: 0;
}
h4 + p {
  font-style: italic;
  font-Size: 10px;
  padding-top: 0;
margin-top: 0;
}

h4.loader {
color: purple;
text-align: center;
}

h6.errorChecker {
  text-align: center;
  color: crimson;
}

img {
  font-size: 8px;
  width: 400px;
}

i {
  font-size: 8px;
  margin-top: 0;
}

a {
  text-decoration: none;
  color: black;
}

a + p {
  margin-bottom: 0;
  font-size: 11px;
}
      </style>
  </head>
  <body>
    <h1>NY Times </h1>
    <h4>First Titles</h4>
    <p></p>
    <section id="allArticles">
<h4 class="loader">...Loading articles</h4>
<h6 class="errorChecker"></h6>
      </section>
    <script>
      let setLoader = document.querySelector(".loader");
      let setError = document.querySelector(".errorChecker");
      let myItalic = document.getElementsByTagName("p")[0];
            let articles = [];
let allArticles = document.querySelector("#allArticles");
const updateDate =()=>{
  let currentDate = new Date();
let currentWeekDay = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
let currentWeekMonth = ["December", "January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November"];
let currentDay = currentDate.getDay();
let currentDayName = currentWeekDay[currentDay];
let currentDayNumber = currentDate.getDate();
let currentMonthName = currentWeekMonth[currentDate.getMonth()];
let currentYear = currentDate.getFullYear();
let textItalic = document.createTextNode(`Last update on ${currentDayName}, ${currentDayNumber} of ${currentMonthName} ${currentYear}`);
myItalic.appendChild(textItalic);
}

const getArticles=()=>{
  setLoader.style.display = 'none';
let Url = "https://ny-times-api-test1.herokuapp.com/article";
try{
let articlesFetched = fetch(Url);
if(Response){
articlesFetched.then(data => data.json()).then(news => {
  for(i=0; i<10; i++){
    articles.push(news[i]);
    };
    }).then(()=>{
      let newElement = document.createElement("div");
     allArticles.appendChild(newElement);
     newElement.innerHTML = articles.map(title =>`<div><div style="display:${title ? "none" : "block"}; color: yellowgreen;"><h6>Loading article...</h6></div>
      <a href=${title.web_url}><h5>${title.headline.main}</h5>
      <img alt="${(title.abstract).slice(0,20)}..." src=${title.url} title="${(title.headline.main).slice(0, 20)}..."></a>
      <p>${title.snippet}</p>
      <i>${title.source}</i>
      </div>`).join("");
    
      
      
    });
setLoader.style.display = 'none';
} else {
  let errorText = document.createTextNode("Cannot retrieve the data. Please try to refresh the page.");
  setLoader.style.display = 'none';
  setError.appendChild(errorText);
}
}catch(err){
  console.log(err);
  let errorText2 = document.createTextNode("An error occured. Please contact your administrator.");
  setError.appendChild(errorText2);
}
}
const loadJS =()=>{
updateDate();
  getArticles();
}
      window.onLoad = loadJS();
    </script>
  </body>
</html>
